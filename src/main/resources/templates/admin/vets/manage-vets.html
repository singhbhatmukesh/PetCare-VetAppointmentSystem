<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Manage Vets</title>

<!-- Bootstrap -->
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css"
	rel="stylesheet">

<!-- Admin CSS -->
<link href="/css/admin-home.css" rel="stylesheet">
</head>
<body>

	<!-- Header -->
	<div th:replace="~{admin/admin-fragments::header}"></div>

	<div class="admin-wrapper">

		<!-- Sidebar -->
		<div th:replace="~{admin/admin-fragments::sidebar}"></div>

		<!-- Main Content -->
		<div class="main-content">

			<!-- Top Bar -->
			<div th:replace="~{admin/admin-fragments::navbar}"></div>

			<!-- Page Content -->
			<div class="container-fluid">

				<div class="d-flex justify-content-between align-items-center mb-3">
					<h4 class="mb-0">Manage Vets</h4>
					<a th:href="@{/admin/vets/add}" class="btn btn-primary"> <i
						class="bi bi-plus-circle me-1"></i> Add Vet
					</a>
				</div>

				<div class="card shadow-sm">
					<div class="card-body p-0">

						<!-- Success Message -->
						<div th:if="${success}"
							class="alert alert-success alert-dismissible fade show">
							<i class="bi bi-check-circle me-2"></i> <span
								th:text="${success}"></span>
							<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
						</div>

						<table class="table table-hover mb-0">
							<thead class="table-secondary">
								<tr>
									<th>#</th>
									<th>Name</th>
									<th>Email</th>
									<th>Specialization</th>
									<th>Total Appointments</th>
									<th>Availability</th>
									<th class="text-center">Actions</th>
								</tr>
							</thead>
							<tbody>
								<tr th:each="vet, stat : ${vets}">
									<td th:text="${currentPage * pageSize + stat.count}"></td>
									<td th:text="${vet.name}"></td>
									<td th:text="${vet.email}"></td>
									<td th:text="${vet.specialization}"></td>
									<td><span class="fw-semibold"
										th:text="${vet.appointments != null ? vet.appointments.size() : 0}">
											0 </span> <a
										th:href="@{/admin/vets/{id}/appointments(id=${vet.id})}"
										class="btn btn-sm btn-outline-secondary ms-2"
										title="Edit Appointments"> <i class="bi bi-calendar-check"></i>
									</a></td>
									<td>
											<form
												th:action="@{/admin/vets/{id}/availability(id=${vet.id})}"
												method="post">
												<button type="submit" name="isavailable"
													th:value="${!vet.isavailable}"
													th:class="'btn btn-sm ' + (${vet.isavailable} ? 'btn-success' : 'btn-secondary')">
													<i class="bi"
														th:classappend="${vet.isavailable} ? 'bi-check-circle' : 'bi-x-circle'"></i>
													<span
														th:text="${vet.isavailable} ? 'Available' : 'Unavailable'"></span>
												</button>
	
											</form>
									</td>



									<td class="text-center">
										<!-- View --> <a
										th:href="@{/admin/vets/detail/{id}(id=${vet.id})}"
										class="btn btn-sm btn-outline-primary me-1" title="View">
											<i class="bi bi-eye"></i>
									</a> <!-- Edit --> <a
										th:href="@{/admin/vets/edit/{id}(id=${vet.id})}"
										class="btn btn-sm btn-outline-warning me-1" title="Edit">
											<i class="bi bi-pencil-square"></i>
									</a> <!-- Delete --> <a
										th:href="@{/admin/vets/delete/{id}(id=${vet.id})}"
										class="btn btn-sm btn-outline-danger" title="Delete"
										onclick="return confirm('Are you sure you want to delete this vet?');">
											<i class="bi bi-trash"></i>
									</a>
									</td>
								</tr>
							</tbody>
						</table>

						<!-- Pagination -->
						<nav class="mt-3">
							<ul class="pagination justify-content-end mb-0">

								<li class="page-item"
									th:classappend="${currentPage == 0} ? 'disabled'"><a
									class="page-link"
									th:href="@{/admin/vets(page=${currentPage - 1})}"> Previous
								</a></li>

								<li class="page-item"
									th:each="i : ${#numbers.sequence(0, totalPages - 1)}"
									th:classappend="${i == currentPage} ? 'active'"><a
									class="page-link" th:href="@{/admin/vets(page=${i})}"
									th:text="${i + 1}"> </a></li>

								<li class="page-item"
									th:classappend="${currentPage + 1 == totalPages} ? 'disabled'">
									<a class="page-link"
									th:href="@{/admin/vets(page=${currentPage + 1})}"> Next </a>
								</li>

							</ul>
						</nav>

					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Footer -->
	<div th:replace="~{admin/admin-fragments::footer}"></div>
	<div th:replace="~{admin/admin-fragments::sidebar-js}"></div>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
